<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Registro de Datos</title>
    <link rel="stylesheet" href="/index.css" />
  </head>
  <body>
    <div class="container">
      <h1>Registro de Datos prueba</h1>

      <form action="/start" method="post">
        <button type="submit" class="btn">Start</button>
      </form>

      <form action="/validar" method="post">
        <label for="name">Nombre:</label>
        <input type="text" name="name" id="name" required />
        <button type="submit" class="btn">Registrar</button>
      </form>

      <form action="/commit" method="post">
        <button type="submit" class="btn">Commit</button>
      </form>

      <form action="/rollback" method="post">
        <button type="submit" class="btn">Cancelar</button>
      </form>
      <a href="/" class="back-link">Regresar</a>
    </div>
    <h2>Control de aislamiento</h2>
    
<select id="level">
  <option>READ UNCOMMITTED</option>
  <option>READ COMMITTED</option>
  <option>REPEATABLE READ</option>
  <option>SERIALIZABLE</option>
</select>
<button onclick="setLevel()">Cambiar</button>
<button onclick="getLevel()">Ver actual</button>

<h3>Pruebas</h3>
<button onclick="fetch('/demo/dirty').then(r=>r.json()).then(console.log)">Lectura sucia</button>
<button onclick="fetch('/demo/non-repeatable').then(r=>r.json()).then(console.log)">Lectura no repetible</button>
<button onclick="fetch('/demo/phantom').then(r=>r.json()).then(console.log)">Lectura fantasma</button>

<script>
function setLevel() {
    fetch('/isolation', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ level: document.getElementById('level').value })
    }).then(r=>r.json()).then(console.log);
}

function getLevel() {
    fetch('/isolation')
        .then(r=>r.json())
        .then(console.log);
}
</script>
  </body>
</html>
